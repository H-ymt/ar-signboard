# AR 看板アプリ - フェーズ2: コア機能設計書

**作成日**: 2025-10-14
**バージョン**: 1.0.0
**フェーズ**: Phase 2 - コア機能実装
**前提**: フェーズ1（基盤構築）が完了している状態
**実装期間**: 1週間（想定）

## 1. 設計の目的と概要

### 1.1 目的

フェーズ2では、AR看板アプリケーションの**コア機能**を実装します。具体的には以下の機能を提供します：

- MindARとA-Frameを使用したAR機能の初期化
- カメラアクセスとパーミッション管理
- 画像認識ターゲットのトラッキング準備
- エラーハンドリングとユーザーフィードバック
- TypeScriptによる型安全な実装基盤

### 1.2 前提条件

- フェーズ1（基盤構築）が完了していること
  - ✅ React + TypeScript + Vite環境
  - ✅ Tailwind CSS v4設定
  - ✅ ESLint / Prettier設定
  - ✅ 基本ディレクトリ構造

### 1.3 成果物

このフェーズ完了時には以下が動作すること：

- ブラウザ対応チェック機能
- カメラアクセス許可/拒否の処理
- MindARの初期化とエラーハンドリング
- ローディング画面とエラーダイアログUI
- 初期化完了後の確認画面

---

## 2. アーキテクチャ設計

### 2.1 レイヤー構造

```
┌─────────────────────────────────────┐
│         UI Components Layer         │  ← LoadingScreen, ErrorDialog
├─────────────────────────────────────┤
│       Custom Hooks Layer            │  ← useCamera, useARInitialize
├─────────────────────────────────────┤
│      Service/Controller Layer       │  ← MindARController
├─────────────────────────────────────┤
│       Utilities Layer               │  ← logger, browser, validation
├─────────────────────────────────────┤
│    Types & Constants Layer          │  ← 型定義、定数定義
└─────────────────────────────────────┘
```

### 2.2 データフロー

```
[User Action]
     ↓
[App Component]
     ↓
[useCamera Hook] → Camera Permission → [MediaStream]
     ↓
[useARInitialize Hook] → Browser Check → MindAR Init
     ↓
[MindARController] → MindAR Library
     ↓
[Success/Error State]
     ↓
[UI Components (Loading/Error/Success)]
```

---

## 3. 詳細設計

### 3.1 依存関係のインストール

**目的**: MindAR と A-Frame の導入

**タスク**:

```bash
# 必須パッケージのインストール
pnpm add mind-ar aframe

# 型定義のインストール
pnpm add -D @types/aframe @types/three
```

**確認事項**:
- `package.json` に追加されているか
- TypeScript の型解決が正常に動作するか

---

### 3.2 型定義ファイルの作成

**目的**: TypeScript による型安全性の確保

#### 3.2.1 AR 関連型（`src/types/ar.ts`）

```typescript
// MindAR 設定
export interface MindARConfig {
  targetUrl: string;
  maxTrack: number;
  filterMinCF: number;
  filterBeta: number;
}

// Transform（位置・回転・拡大縮小）
export interface Transform {
  position: [number, number, number];
  rotation: [number, number, number];
  scale: [number, number, number];
}

// トラッキング状態
export interface TrackingState {
  targetFound: boolean;
  isTracking: boolean;
  confidence: number;
}

// エラー型
export enum ARErrorType {
  BROWSER_NOT_SUPPORTED = 'BROWSER_NOT_SUPPORTED',
  CAMERA_PERMISSION_DENIED = 'CAMERA_PERMISSION_DENIED',
  CAMERA_ACCESS_FAILED = 'CAMERA_ACCESS_FAILED',
  MINDAR_INIT_FAILED = 'MINDAR_INIT_FAILED',
  AFRAME_INIT_FAILED = 'AFRAME_INIT_FAILED',
  TARGET_LOAD_FAILED = 'TARGET_LOAD_FAILED',
  MODEL_LOAD_FAILED = 'MODEL_LOAD_FAILED',
  TRACKING_FAILED = 'TRACKING_FAILED',
  CAPTURE_FAILED = 'CAPTURE_FAILED',
  SAVE_FAILED = 'SAVE_FAILED',
  UNKNOWN_ERROR = 'UNKNOWN_ERROR',
}

export interface ARError {
  type: ARErrorType;
  message: string;
  recoverable: boolean;
  action?: string;
}

// 初期化状態
export interface InitializeState {
  isInitialized: boolean;
  isInitializing: boolean;
  error: ARError | null;
}
```

#### 3.2.2 カメラ関連型（`src/types/camera.ts`）

```typescript
export type CameraPermission = 'pending' | 'granted' | 'denied';

export interface CameraConstraints {
  video: {
    facingMode: 'environment';
    width: { ideal: number };
    height: { ideal: number };
  };
}

export interface CameraState {
  permission: CameraPermission;
  stream: MediaStream | null;
  error: ARError | null;
}
```

#### 3.2.3 看板関連型（`src/types/signboard.ts`）

```typescript
export type SignboardType = 'image' | 'model';

export interface SignboardDesign {
  id: string;
  name: string;
  type: SignboardType;
  src: string;
  defaultScale: [number, number, number];
  thumbnail?: string;
}
```

#### 3.2.4 UI 関連型（`src/types/ui.ts`）

```typescript
export type AppScreen =
  | 'loading'
  | 'camera-permission'
  | 'scanning'
  | 'ar-view'
  | 'capture-preview'
  | 'error';

export interface UIState {
  currentScreen: AppScreen;
  showControlsHelp: boolean;
  showDesignSwitcher: boolean;
  capturedImage: string | null;
}
```

---

### 3.3 定数定義の作成

#### 3.3.1 AR 設定（`src/constants/ar.ts`）

```typescript
import type { MindARConfig, CameraConstraints } from '../types/ar';
import type { CameraConstraints as CameraConstraintsType } from '../types/camera';

export const MINDAR_CONFIG: MindARConfig = {
  targetUrl: '/targets/default-target.mind',
  maxTrack: 1,
  filterMinCF: 0.0001,
  filterBeta: 0.001,
};

export const CAMERA_CONSTRAINTS: CameraConstraintsType = {
  video: {
    facingMode: 'environment',
    width: { ideal: 1280 },
    height: { ideal: 720 },
  },
};

export const DEFAULT_TRANSFORM = {
  position: [0, 0, 0] as [number, number, number],
  rotation: [0, 0, 0] as [number, number, number],
  scale: [1, 1, 1] as [number, number, number],
};
```

#### 3.3.2 アプリケーション設定（`src/constants/config.ts`）

```typescript
export const PERFORMANCE_CONFIG = {
  // モデル制限
  MAX_MODEL_SIZE: 3 * 1024 * 1024, // 3MB
  MAX_POLYGON_COUNT: 50000,

  // テクスチャ制限
  MAX_TEXTURE_SIZE: 2048,

  // フレームレート
  TARGET_FPS: 60,
  MIN_FPS: 30,

  // メモリ監視
  MEMORY_CHECK_INTERVAL: 5000, // 5秒
  MAX_MEMORY_USAGE: 100 * 1024 * 1024, // 100MB
};

export const UI_CONFIG = {
  // 操作説明の自動非表示時間（ミリ秒）
  CONTROLS_HELP_TIMEOUT: 5000,

  // ローディングスピナーの最小表示時間
  MIN_LOADING_TIME: 500,

  // エラーメッセージの表示時間
  ERROR_DISPLAY_TIME: 5000,
};
```

#### 3.3.3 エラーメッセージ（`src/constants/errors.ts`）

```typescript
import { ARErrorType } from '../types/ar';

export const ERROR_MESSAGES: Record<ARErrorType, string> = {
  BROWSER_NOT_SUPPORTED:
    'お使いのブラウザはAR機能に対応していません。\nSafari（iOS）またはChrome（Android）をご利用ください。',
  CAMERA_PERMISSION_DENIED:
    'カメラへのアクセスが許可されていません。\nブラウザの設定からカメラの使用を許可してください。',
  CAMERA_ACCESS_FAILED:
    'カメラの起動に失敗しました。\n他のアプリでカメラを使用していないか確認してください。',
  MINDAR_INIT_FAILED:
    'AR機能の初期化に失敗しました。\nページを再読み込みしてください。',
  AFRAME_INIT_FAILED:
    'AR表示エンジンの初期化に失敗しました。\nページを再読み込みしてください。',
  TARGET_LOAD_FAILED:
    '認識用画像の読み込みに失敗しました。\nネットワーク接続を確認してください。',
  MODEL_LOAD_FAILED:
    '看板モデルの読み込みに失敗しました。\nネットワーク接続を確認してください。',
  TRACKING_FAILED:
    '画像の認識に失敗しました。\n対象の画像をカメラに映してください。',
  CAPTURE_FAILED:
    '写真の撮影に失敗しました。\nもう一度お試しください。',
  SAVE_FAILED:
    '写真の保存に失敗しました。\nストレージの空き容量を確認してください。',
  UNKNOWN_ERROR:
    '予期しないエラーが発生しました。\nページを再読み込みしてください。',
};
```

---

### 3.4 ユーティリティ関数の作成

#### 3.4.1 ブラウザ判定（`src/utils/browser.ts`）

```typescript
export const isBrowserSupported = (): boolean => {
  const ua = navigator.userAgent.toLowerCase();

  // iOS Safari または Android Chrome のみ対応
  const isIOS = /iphone|ipad|ipod/.test(ua);
  const isAndroid = /android/.test(ua);
  const isChrome = /chrome/.test(ua);
  const isSafari = /safari/.test(ua) && !/chrome/.test(ua);

  return (isIOS && isSafari) || (isAndroid && isChrome);
};

export const getBrowserInfo = () => {
  const ua = navigator.userAgent;
  return {
    userAgent: ua,
    isIOS: /iphone|ipad|ipod/i.test(ua),
    isAndroid: /android/i.test(ua),
    isMobile: /mobile/i.test(ua),
  };
};

export const hasWebGL = (): boolean => {
  try {
    const canvas = document.createElement('canvas');
    return !!(
      canvas.getContext('webgl') || canvas.getContext('experimental-webgl')
    );
  } catch (e) {
    return false;
  }
};
```

#### 3.4.2 バリデーション（`src/utils/validation.ts`）

```typescript
import { PERFORMANCE_CONFIG } from '../constants/config';

export const validateModelSize = (sizeInBytes: number): boolean => {
  return sizeInBytes <= PERFORMANCE_CONFIG.MAX_MODEL_SIZE;
};

export const validateImageUrl = (url: string): boolean => {
  const imageExtensions = /\.(jpg|jpeg|png|gif|webp)$/i;
  return imageExtensions.test(url);
};

export const validateModelUrl = (url: string): boolean => {
  const modelExtensions = /\.(glb|gltf)$/i;
  return modelExtensions.test(url);
};
```

#### 3.4.3 ロガー（`src/utils/logger.ts`）

```typescript
type LogLevel = 'info' | 'warn' | 'error' | 'debug';

class Logger {
  private isDevelopment = import.meta.env.DEV;

  private log(level: LogLevel, message: string, data?: unknown) {
    if (!this.isDevelopment && level === 'debug') return;

    const timestamp = new Date().toISOString();
    const prefix = `[${timestamp}] [${level.toUpperCase()}]`;

    switch (level) {
      case 'error':
        console.error(prefix, message, data || '');
        break;
      case 'warn':
        console.warn(prefix, message, data || '');
        break;
      case 'info':
        console.info(prefix, message, data || '');
        break;
      case 'debug':
        console.debug(prefix, message, data || '');
        break;
    }
  }

  info(message: string, data?: unknown) {
    this.log('info', message, data);
  }

  warn(message: string, data?: unknown) {
    this.log('warn', message, data);
  }

  error(message: string, data?: unknown) {
    this.log('error', message, data);
  }

  debug(message: string, data?: unknown) {
    this.log('debug', message, data);
  }
}

export const logger = new Logger();
```

---

### 3.5 カメラアクセス実装

#### 3.5.1 カメラアクセスフック（`src/hooks/useCamera.ts`）

```typescript
import { useState, useEffect } from 'react';
import type { CameraState } from '../types/camera';
import { CAMERA_CONSTRAINTS } from '../constants/ar';
import { ARErrorType } from '../types/ar';
import { logger } from '../utils/logger';

export const useCamera = () => {
  const [state, setState] = useState<CameraState>({
    permission: 'pending',
    stream: null,
    error: null,
  });

  const requestCameraPermission = async () => {
    try {
      logger.info('Requesting camera permission...');

      const stream = await navigator.mediaDevices.getUserMedia(
        CAMERA_CONSTRAINTS
      );

      setState({
        permission: 'granted',
        stream,
        error: null,
      });

      logger.info('Camera permission granted');
    } catch (error) {
      logger.error('Camera permission denied or failed', error);

      const errorType =
        (error as Error).name === 'NotAllowedError'
          ? ARErrorType.CAMERA_PERMISSION_DENIED
          : ARErrorType.CAMERA_ACCESS_FAILED;

      setState({
        permission: 'denied',
        stream: null,
        error: {
          type: errorType,
          message: (error as Error).message,
          recoverable: errorType === ARErrorType.CAMERA_PERMISSION_DENIED,
        },
      });
    }
  };

  const stopCamera = () => {
    if (state.stream) {
      state.stream.getTracks().forEach((track) => track.stop());
      setState((prev) => ({ ...prev, stream: null }));
      logger.info('Camera stopped');
    }
  };

  // クリーンアップ
  useEffect(() => {
    return () => {
      stopCamera();
    };
  }, []);

  return {
    ...state,
    requestCameraPermission,
    stopCamera,
  };
};
```

---

### 3.6 MindAR 初期化実装

#### 3.6.1 MindAR コントローラー（`src/ar/MindARController.ts`）

```typescript
import type { MindARConfig } from '../types/ar';
import { ARErrorType } from '../types/ar';
import { logger } from '../utils/logger';

export class MindARController {
  private mindarThree: any = null;
  private isInitialized = false;

  async initialize(config: MindARConfig) {
    try {
      logger.info('Initializing MindAR...', config);

      // MindAR の動的インポート
      const { MindARThree } = await import('mind-ar/dist/mindar-image-three.prod.js');

      this.mindarThree = new MindARThree({
        container: document.body,
        imageTargetSrc: config.targetUrl,
        maxTrack: config.maxTrack,
        filterMinCF: config.filterMinCF,
        filterBeta: config.filterBeta,
      });

      await this.mindarThree.start();
      this.isInitialized = true;

      logger.info('MindAR initialized successfully');
    } catch (error) {
      logger.error('MindAR initialization failed', error);
      throw {
        type: ARErrorType.MINDAR_INIT_FAILED,
        message: (error as Error).message,
        recoverable: true,
      };
    }
  }

  stop() {
    if (this.mindarThree) {
      this.mindarThree.stop();
      logger.info('MindAR stopped');
    }
  }

  getMindarThree() {
    return this.mindarThree;
  }

  isReady() {
    return this.isInitialized;
  }
}
```

#### 3.6.2 AR 初期化フック（`src/hooks/useARInitialize.ts`）

```typescript
import { useState } from 'react';
import type { InitializeState } from '../types/ar';
import { isBrowserSupported } from '../utils/browser';
import { ARErrorType } from '../types/ar';
import { MindARController } from '../ar/MindARController';
import { MINDAR_CONFIG } from '../constants/ar';
import { logger } from '../utils/logger';

export const useARInitialize = () => {
  const [state, setState] = useState<InitializeState>({
    isInitialized: false,
    isInitializing: false,
    error: null,
  });

  const [controller] = useState(() => new MindARController());

  const initialize = async () => {
    try {
      setState({ isInitializing: true, isInitialized: false, error: null });

      // 1. ブラウザ対応チェック
      if (!isBrowserSupported()) {
        throw {
          type: ARErrorType.BROWSER_NOT_SUPPORTED,
          message: 'Browser not supported',
          recoverable: false,
        };
      }

      // 2. MindAR初期化
      await controller.initialize(MINDAR_CONFIG);

      setState({ isInitialized: true, isInitializing: false, error: null });
    } catch (error) {
      logger.error('AR initialization failed', error);
      setState({
        isInitialized: false,
        isInitializing: false,
        error: error as any,
      });
    }
  };

  const cleanup = () => {
    controller.stop();
  };

  return { ...state, initialize, cleanup, controller };
};
```

---

### 3.7 簡易ローディング画面の実装

#### 3.7.1 LoadingScreen コンポーネント（`src/components/ui/LoadingScreen.tsx`）

```typescript
export const LoadingScreen = () => {
  return (
    <div className="fixed inset-0 z-50 flex flex-col items-center justify-center bg-gray-900">
      <div className="mb-4 h-16 w-16 animate-spin rounded-full border-4 border-gray-700 border-t-blue-500"></div>
      <p className="text-lg text-white">AR機能を初期化しています...</p>
    </div>
  );
};
```

#### 3.7.2 ErrorDialog コンポーネント（`src/components/ui/ErrorDialog.tsx`）

```typescript
import type { ARError } from '../../types/ar';
import { ERROR_MESSAGES } from '../../constants/errors';

interface ErrorDialogProps {
  error: ARError;
  onRetry?: () => void;
  onClose?: () => void;
}

export const ErrorDialog = ({ error, onRetry, onClose }: ErrorDialogProps) => {
  const message = ERROR_MESSAGES[error.type];

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70">
      <div className="mx-4 max-w-md rounded-lg bg-white p-6 shadow-xl">
        <h2 className="mb-4 text-xl font-bold text-red-600">エラー</h2>
        <p className="mb-6 whitespace-pre-line text-gray-700">{message}</p>
        <div className="flex justify-end gap-3">
          {onClose && (
            <button
              onClick={onClose}
              className="rounded bg-gray-300 px-4 py-2 text-gray-700 hover:bg-gray-400"
            >
              閉じる
            </button>
          )}
          {error.recoverable && onRetry && (
            <button
              onClick={onRetry}
              className="rounded bg-blue-500 px-4 py-2 text-white hover:bg-blue-600"
            >
              再試行
            </button>
          )}
        </div>
      </div>
    </div>
  );
};
```

---

### 3.8 App.tsx の基本実装

```typescript
import { useState } from 'react';
import { useARInitialize } from './hooks/useARInitialize';
import { useCamera } from './hooks/useCamera';
import { LoadingScreen } from './components/ui/LoadingScreen';
import { ErrorDialog } from './components/ui/ErrorDialog';

function App() {
  const { isInitializing, isInitialized, error: arError, initialize } = useARInitialize();
  const { permission, error: cameraError, requestCameraPermission } = useCamera();

  const [showError, setShowError] = useState(false);

  const handleStart = async () => {
    await requestCameraPermission();
    if (permission === 'granted') {
      await initialize();
    }
  };

  const currentError = arError || cameraError;

  return (
    <div className="h-screen w-screen">
      {isInitializing && <LoadingScreen />}

      {currentError && (
        <ErrorDialog
          error={currentError}
          onRetry={handleStart}
          onClose={() => setShowError(false)}
        />
      )}

      {!isInitialized && !isInitializing && (
        <div className="flex h-full items-center justify-center bg-gray-900">
          <button
            onClick={handleStart}
            className="rounded-lg bg-blue-500 px-8 py-4 text-xl font-bold text-white hover:bg-blue-600"
          >
            AR体験を開始
          </button>
        </div>
      )}

      {isInitialized && (
        <div className="flex h-full items-center justify-center bg-green-900">
          <p className="text-2xl text-white">AR初期化完了！（次のフェーズで実装）</p>
        </div>
      )}
    </div>
  );
}

export default App;
```

---

---

## 4. 実装順序と工数見積もり

### 4.1 推奨実装順序

1. **依存関係インストール** (15分)
2. **型定義** (1時間)
3. **定数定義** (30分)
4. **ユーティリティ** (1時間)
5. **カメラアクセス** (1.5時間)
6. **MindAR 初期化** (2時間)
7. **UI コンポーネント** (1時間)
8. **App.tsx 統合** (1時間)
9. **動作確認・デバッグ** (2時間)

**合計工数**: 約10.5時間（1.5日相当）

---

## 5. テスト計画

### 5.1 単体テスト項目

#### ユーティリティ関数
- [ ] `isBrowserSupported()` が正しくブラウザを判定する
- [ ] `hasWebGL()` がWebGL対応を正しく判定する
- [ ] `validateModelSize()` がファイルサイズを正しく検証する
- [ ] `validateImageUrl()` が画像URLを正しく検証する
- [ ] `validateModelUrl()` がモデルURLを正しく検証する

#### カスタムフック
- [ ] `useCamera` がカメラ許可を正しくリクエストする
- [ ] `useCamera` がカメラ拒否時に適切なエラーを返す
- [ ] `useCamera` がクリーンアップ時にストリームを停止する
- [ ] `useARInitialize` が非対応ブラウザでエラーを返す
- [ ] `useARInitialize` がMindAR初期化に成功する

### 5.2 統合テスト項目

#### 正常系
- [ ] アプリ起動時に「AR体験を開始」ボタンが表示される
- [ ] ボタンクリック時にカメラ許可ダイアログが表示される
- [ ] カメラ許可後にローディング画面が表示される
- [ ] MindAR初期化後に成功画面が表示される

#### 異常系
- [ ] 非対応ブラウザでエラーダイアログが表示される
- [ ] カメラ拒否時にエラーダイアログが表示される
- [ ] カメラアクセス失敗時にエラーダイアログが表示される
- [ ] MindAR初期化失敗時にエラーダイアログが表示される
- [ ] エラーダイアログの「再試行」ボタンが動作する

### 5.3 実機テスト項目

#### iOS Safari
- [ ] iPhone（iOS 15以降）でカメラアクセスが動作する
- [ ] iPad（iOS 15以降）でカメラアクセスが動作する
- [ ] MindAR初期化が成功する
- [ ] エラーメッセージが適切に表示される

#### Android Chrome
- [ ] Android 10以降でカメラアクセスが動作する
- [ ] MindAR初期化が成功する
- [ ] エラーメッセージが適切に表示される

### 5.4 パフォーマンステスト

- [ ] 初期化時間が5秒以内
- [ ] メモリ使用量が100MB以下
- [ ] TypeScriptコンパイルエラーなし
- [ ] ESLintエラーなし
- [ ] ビルドサイズが適切（目安: 500KB以下）

---

## 6. リスクと対策

### 6.1 技術的リスク

| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|----------|------|
| MindARライブラリの型定義不足 | 中 | 高 | カスタム型定義ファイルを作成 |
| iOS Safariでのカメラアクセス制限 | 高 | 中 | HTTPSでの配信を必須化 |
| ブラウザ互換性問題 | 中 | 中 | ポリフィル追加、フォールバック実装 |
| メモリリーク | 高 | 中 | useEffectのクリーンアップを徹底 |
| 初期化タイムアウト | 中 | 低 | タイムアウト処理とリトライ機能 |

### 6.2 スケジュールリスク

| リスク | 対策 |
|--------|------|
| MindAR学習コストが高い | 公式ドキュメント・サンプル事前調査 |
| デバッグ時間超過 | 段階的実装、こまめな動作確認 |
| 実機テストの遅延 | 早期から実機での動作確認 |

---

## 7. 次フェーズへの準備

### 7.1 フェーズ3の前提条件

フェーズ2完了後、以下が達成されていること：

- ✅ カメラアクセスが安定して動作する
- ✅ MindAR初期化が成功する
- ✅ エラーハンドリングが適切に動作する
- ✅ 型定義が整備されている
- ✅ ユーティリティ関数が揃っている

### 7.2 フェーズ3の実装内容（予定）

#### フェーズ3: AR表示とインタラクション（1週間）
- A-Frameシーンの構築
- ターゲット画像の配置
- 2D看板画像の表示
- タッチジェスチャー（ドラッグ、ピンチ、回転）
- デザイン切替UI

#### フェーズ4: 撮影・保存機能（1週間）
- AR画面のキャプチャ
- プレビュー画面
- 端末への保存機能
- SNS共有機能（オプション）

---

## 8. 参考資料

### 8.1 公式ドキュメント

- [MindAR Documentation](https://hiukim.github.io/mind-ar-js-doc/)
- [A-Frame Documentation](https://aframe.io/docs/)
- [React TypeScript Cheatsheet](https://react-typescript-cheatsheet.netlify.app/)
- [Tailwind CSS v4 Documentation](https://tailwindcss.com/docs)

### 8.2 関連技術

- [Three.js Documentation](https://threejs.org/docs/)
- [WebGL Fundamentals](https://webglfundamentals.org/)
- [MediaDevices API](https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices)

---

## 9. チェックリスト

フェーズ2完了時の確認項目：

### コード品質
- [ ] TypeScriptの型チェックが通る（`pnpm build`）
- [ ] ESLintエラーがない（`pnpm lint`）
- [ ] Prettierでフォーマット済み（`pnpm format`）
- [ ] コミット前フックが動作する

### 機能確認
- [ ] ブラウザ対応チェックが動作する
- [ ] カメラ許可リクエストが正常に動作する
- [ ] カメラ拒否時のエラー表示が適切
- [ ] MindAR初期化が成功する
- [ ] エラーハンドリングが適切に動作する
- [ ] ローディング画面が表示される
- [ ] エラーダイアログの再試行ボタンが動作する

### 実機テスト
- [ ] iOS Safariで動作確認済み
- [ ] Android Chromeで動作確認済み
- [ ] カメラアクセスが正常に動作する
- [ ] エラーメッセージが読みやすい

### ドキュメント
- [ ] READMEに開発手順を記載
- [ ] 設計書を最新の状態に更新
- [ ] コードコメントが適切

---

**以上がフェーズ2の詳細設計書です。実装を開始してよろしいでしょうか？**
